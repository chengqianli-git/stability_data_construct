CREATE TABLE primary_key_optimized (
    -- === 主键列 (5列) ===
    id BIGINT,
    tenant_id INT,
    event_date DATE,
    business_key VARCHAR(50),
    region_code VARCHAR(10),

    -- === 数值类型 (95列) ===
    user_id BIGINT,
    product_id BIGINT,
    order_id BIGINT,
    customer_id BIGINT,
    supplier_id BIGINT,
    employee_id INT,
    department_id SMALLINT,
    category_id INT,
    location_id BIGINT,
    warehouse_id INT,
    transaction_id BIGINT,
    session_id BIGINT,
    device_id BIGINT,
    tinyint_col1 TINYINT,
    tinyint_col2 TINYINT,
    smallint_col1 SMALLINT,
    smallint_col2 SMALLINT,
    int_col1 INT,
    int_col2 INT,
    bigint_col1 BIGINT,
    bigint_col2 BIGINT,
    largeint_col LARGEINT,
    decimal_p5_s2 DECIMAL(5,2),
    decimal_p10_s4 DECIMAL(10,4),
    decimal_p15_s6 DECIMAL(15,6),
    decimal_p20_s8 DECIMAL(20,8),
    decimal_p28_s10 DECIMAL(28,10),
    decimal_p38_s12 DECIMAL(38,12),
    decimal_p10_s0 DECIMAL(10,0),
    decimal_p18_s0 DECIMAL(18,0),
    decimal_p8_s3 DECIMAL(8,3),
    decimal_p12_s2 DECIMAL(12,2),
    float_col1 FLOAT,
    float_col2 FLOAT,
    double_col1 DOUBLE,
    double_col2 DOUBLE,
    is_active BOOLEAN,
    is_valid BOOLEAN,
    is_approved BOOLEAN,
    is_completed BOOLEAN,
    amount_total DECIMAL(18,4),
    amount_subtotal DECIMAL(16,4),
    amount_tax DECIMAL(12,2),
    amount_shipping DECIMAL(10,2),
    amount_fee DECIMAL(8,2),
    quantity_ordered INT,
    quantity_shipped INT,
    quantity_returned SMALLINT,
    quantity_backordered SMALLINT,
    unit_cost DECIMAL(12,4),
    unit_price DECIMAL(12,4),
    margin_percent DECIMAL(5,2),
    tax_rate DECIMAL(6,4),
    discount_rate DECIMAL(5,3),
    commission_rate DECIMAL(5,3),
    weight_kg DECIMAL(10,3),
    volume_liters DECIMAL(10,3),
    length_cm DECIMAL(8,2),
    width_cm DECIMAL(8,2),
    height_cm DECIMAL(8,2),
    area_sqm DECIMAL(10,3),
    temperature_c FLOAT,
    humidity_percent DECIMAL(5,2),
    pressure_kpa DOUBLE,
    speed_kmh FLOAT,
    acceleration_ms2 DOUBLE,
    view_count BIGINT,
    click_count INT,
    conversion_count INT,
    impression_count INT,
    engagement_count INT,
    comment_count INT,
    avg_rating DECIMAL(3,2),
    quality_score DECIMAL(8,3),
    performance_score DECIMAL(9,3),
    success_rate DECIMAL(8,4),
    error_rate DECIMAL(8,4),
    completion_rate DECIMAL(9,3),
    utilization_rate DECIMAL(9,4),
    efficiency_ratio DECIMAL(10,5),
    accuracy_score DECIMAL(8,3),
    reliability_score DECIMAL(8,3),
    balance_current DECIMAL(18,2),
    balance_previous DECIMAL(18,2),
    credit_limit DECIMAL(15,2),
    available_credit DECIMAL(15,2),
    interest_rate DECIMAL(10,5),
    monthly_payment DECIMAL(13,2),
    annual_fee DECIMAL(11,2),
    transaction_fee DECIMAL(9,2),

    -- === 字符串类型 (65列) ===
    -- CHAR类型
    status_code CHAR(1),
    country_code CHAR(2),
    currency_code CHAR(3),
    language_code CHAR(5),
    size_code CHAR(3),
    type_code CHAR(4),
    level_code CHAR(2),

    -- VARCHAR短文本
    short_code VARCHAR(10),
    short_name VARCHAR(20),
    short_desc VARCHAR(50),

    -- 业务字符串
    customer_name VARCHAR(200),
    customer_email VARCHAR(255),
    customer_phone VARCHAR(30),
    contact_name VARCHAR(100),
    contact_email VARCHAR(255),
    contact_phone VARCHAR(20),
    billing_address VARCHAR(500),
    shipping_address VARCHAR(500),
    company_name VARCHAR(200),
    department_name VARCHAR(100),
    team_name VARCHAR(80),

    -- 产品相关
    product_name VARCHAR(300),
    product_description VARCHAR(2000),
    product_sku VARCHAR(100),
    product_upc CHAR(20),
    product_brand VARCHAR(100),
    product_model VARCHAR(80),
    product_category VARCHAR(50),
    product_type VARCHAR(30),

    -- 订单相关
    order_number VARCHAR(50),
    invoice_number VARCHAR(40),
    tracking_number VARCHAR(80),
    receipt_number VARCHAR(30),
    po_number VARCHAR(30),

    -- 支付相关
    payment_method VARCHAR(30),
    payment_gateway VARCHAR(50),
    card_last_four CHAR(4),
    bank_name VARCHAR(100),
    account_number VARCHAR(25),

    -- 地理位置
    country_name VARCHAR(50),
    state_name VARCHAR(50),
    city_name VARCHAR(50),
    postal_code VARCHAR(20),
    timezone_name VARCHAR(50),
    address_line1 VARCHAR(200),
    address_line2 VARCHAR(200),

    -- 技术信息
    ip_address VARCHAR(45),
    user_agent VARCHAR(1000),
    referrer_url VARCHAR(500),
    landing_page VARCHAR(500),
    exit_page VARCHAR(500),
    campaign_name VARCHAR(200),
    ad_group_name VARCHAR(150),
    keyword_text VARCHAR(100),

    -- 设备信息
    device_type VARCHAR(50),
    device_model VARCHAR(80),
    os_name VARCHAR(50),
    os_version VARCHAR(20),
    browser_name VARCHAR(50),
    browser_version VARCHAR(20),

    -- 标识符
    session_id_str VARCHAR(128),
    transaction_id_str VARCHAR(100),
    batch_id VARCHAR(50),
    request_id VARCHAR(80),
    correlation_id VARCHAR(80),

    -- 状态和消息
    status_message VARCHAR(500),
    error_message VARCHAR(1000),
    warning_message VARCHAR(500),
    info_message VARCHAR(500),
    notes_text VARCHAR(2000),

    -- === 日期时间类型 (20列) ===
    created_date DATE,
    created_time DATETIME,
    modified_date DATE,
    modified_time DATETIME,
    processed_date DATE,
    processed_time DATETIME,
    scheduled_date DATE,
    scheduled_time DATETIME,
    effective_date DATE,
    expiry_date DATE,
    start_date DATE,
    end_date DATE,
    last_login_date DATE,
    last_activity_date DATE,
    registration_date DATE,
    birth_date DATE,
    payment_due_date DATE,
    delivery_date DATE,
    completion_date DATE,
    archive_date DATE,

    -- === 半结构化类型 (15列) ===
    json_metadata JSON,
    json_attributes JSON,
    json_settings JSON,
    json_audit_log JSON,
    json_performance_data JSON,
    
    array_tags ARRAY<VARCHAR(50)>,
    array_categories ARRAY<VARCHAR(30)>,
    array_features ARRAY<VARCHAR(100)>,
    array_images ARRAY<VARCHAR(500)>,
    
    map_user_prefs MAP<VARCHAR(50), VARCHAR(200)>,
    map_product_attrs MAP<VARCHAR(40), VARCHAR(150)>,
    
    user_info STRUCT<first_name VARCHAR(50), last_name VARCHAR(50), age INT, email VARCHAR(255), phone VARCHAR(20)>,
    address_info STRUCT<street VARCHAR(200), city VARCHAR(50), state VARCHAR(50), country VARCHAR(50), postal_code VARCHAR(20)>,
    product_info STRUCT<name VARCHAR(200), description VARCHAR(1000), category VARCHAR(50), brand VARCHAR(50), weight DECIMAL(8,3)>,
    device_info STRUCT<type VARCHAR(20), brand VARCHAR(30), model VARCHAR(50), os VARCHAR(20), browser VARCHAR(30)>

) PRIMARY KEY (
    id, tenant_id, event_date, business_key, region_code
)
DISTRIBUTED BY HASH(id, tenant_id) BUCKETS 16
;